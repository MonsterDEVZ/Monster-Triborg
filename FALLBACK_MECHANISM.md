# üõ°Ô∏è Fallback Mechanism - –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–∞—è —Å–∏—Å—Ç–µ–º–∞

## üìã –û–±–∑–æ—Ä

Monster Triborg Bot v2.1 —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç **–Ω–∞–¥—ë–∂–Ω—ã–π fallback –º–µ—Ö–∞–Ω–∏–∑–º**, –∫–æ—Ç–æ—Ä—ã–π –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ **–Ω–∏ –æ–¥–∏–Ω –ª–∏–¥ –Ω–µ –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω**, –¥–∞–∂–µ –µ—Å–ª–∏ AmoCRM –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É
         ‚Üì
–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ AmoCRM
         ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚Üì                 ‚Üì
‚úÖ –£—Å–ø–µ—Ö          ‚ùå –û—à–∏–±–∫–∞
    ‚Üì                 ‚Üì
–°–¥–µ–ª–∫–∞ —Å–æ–∑–¥–∞–Ω–∞   FALLBACK
    ‚Üì                 ‚Üì
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å     –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
–ø–æ–ª—É—á–∞–µ—Ç         –≤ Telegram —Å –¥–∞–Ω–Ω—ã–º–∏
–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ    –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–Ω–µ—Å–µ–Ω–∏—è
```

---

## üîß –ß—Ç–æ –±—ã–ª–æ —É–ª—É—á—à–µ–Ω–æ (v2.1)

### ‚úÖ –§–∞–∑–∞ 1: –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

**–§–∞–π–ª:** `packages/core/utils/crm.py`

**–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ—à–∏–±–æ–∫:**

1. **`aiohttp.ClientConnectorError`** ‚Äî CRM-—Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–Ω–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ)
2. **`aiohttp.ClientResponseError`** ‚Äî CRM –æ—Ç–≤–µ—Ç–∏–ª–∞ —Å –æ—à–∏–±–∫–æ–π (4xx, 5xx)
3. **`asyncio.TimeoutError`** ‚Äî –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞ (>10 —Å–µ–∫—É–Ω–¥)
4. **`aiohttp.ClientError`** ‚Äî –î—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ HTTP-–∫–ª–∏–µ–Ω—Ç–∞
5. **`Exception`** ‚Äî –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

**–í–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:**
- `True` ‚Üí –£—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ (—Å—Ç–∞—Ç—É—Å 200, 201, 202)
- `False` ‚Üí –õ—é–±–∞—è –æ—à–∏–±–∫–∞

### ‚úÖ –§–∞–∑–∞ 2: –î–µ—Ç–∞–ª—å–Ω–æ–µ fallback —Å–æ–æ–±—â–µ–Ω–∏–µ

**–§–∞–π–ª:** `packages/core/handlers/callbacks.py`

**–ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç fallback —Å–æ–æ–±—â–µ–Ω–∏—è:**

```
‚ö†Ô∏è [FALLBACK - CRM –ù–ï–î–û–°–¢–£–ü–ù–ê] ‚ö†Ô∏è

üî• –ù–û–í–´–ô –õ–ò–î: MONSTER AGENCY üî•

‚ùóÔ∏è –í–∞–∂–Ω–æ: –≠—Ç–æ—Ç –ª–∏–¥ –ù–ï –±—ã–ª —Å–æ–∑–¥–∞–Ω –≤ AmoCRM –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
–¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–µ –≤–Ω–µ—Å–µ–Ω–∏–µ.

--- –î–ê–ù–ù–´–ï –î–õ–Ø CRM ---
–ó–∞–ø—Ä–æ—Å: –ü—Ä–∏–≤–ª–µ—á—å –∫–ª–∏–µ–Ω—Ç–æ–≤
–ö–æ–Ω—Ç–∞–∫—Ç (–∞–≤—Ç–æ): @betterrman
–ò–º—è: Galliard
--------------------------

–ó–∞–¥–∞—á–∞:
1. –í–Ω–µ—Å—Ç–∏ –ª–∏–¥ –≤ AmoCRM –≤—Ä—É—á–Ω—É—é.
2. –°–≤—è–∑–∞—Ç—å—Å—è —Å –∫–ª–∏–µ–Ω—Ç–æ–º –≤ Telegram.
```

### ‚úÖ –§–∞–∑–∞ 3: –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–í–∞–∂–Ω–æ:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å **–Ω–µ –≤–∏–¥–∏—Ç** –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º!

–ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, —Å–æ–∑–¥–∞–ª–∞—Å—å —Å–¥–µ–ª–∫–∞ –≤ AmoCRM –∏–ª–∏ —Å—Ä–∞–±–æ—Ç–∞–ª fallback, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç **–æ–¥–Ω–æ –∏ —Ç–æ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ**:

```
‚úÖ –ü—Ä–∏–Ω—è—Ç–æ: –ü—Ä–∏–≤–ª–µ—á—å –∫–ª–∏–µ–Ω—Ç–æ–≤.

üë§ –ù–∞—à —Å—Ç—Ä–∞—Ç–µ–≥ —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ Telegram –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.

üí° –ß—Ç–æ–±—ã —É—Å–∫–æ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å, –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∞—à —Ç–µ–∫—É—â–∏–π —Å–∞–π—Ç –∏–ª–∏ —Å–æ—Ü—Å–µ—Ç—å.
```

–û–ø—ã—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Å—Ç–∞—ë—Ç—Å—è **–±–µ—Å—à–æ–≤–Ω—ã–º**.

---

## üß™ –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ –¢–µ—Å—Ç 1: "–í—Å—ë —Ö–æ—Ä–æ—à–æ" (CRM –¥–æ—Å—Ç—É–ø–Ω–∞)

**–£—Å–ª–æ–≤–∏—è:**
- Webhook URLs –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ
- AmoCRM —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç

**–®–∞–≥–∏:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://t.me/monstrassistentbot?start=agency
2. –ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–Ω–æ–ø–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ü—Ä–∏–≤–ª–µ—á—å –∫–ª–∏–µ–Ω—Ç–æ–≤")

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –í AmoCRM —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤–∞—è —Å–¥–µ–ª–∫–∞
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
- ‚úÖ –í Telegram (ADMIN_CHAT_ID) **–Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç**
- ‚úÖ –í –ª–æ–≥–∞—Ö: `‚úÖ –õ–∏–¥ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ AmoCRM. –°—Ç–∞—Ç—É—Å: 200`

**–ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å—Å—ã–ª–∫–∏:**
- ‚úÖ Follow-up –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤ Telegram

---

### ‚ùå –¢–µ—Å—Ç 2: "CRM –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞" (Fallback)

**–£—Å–ª–æ–≤–∏—è:**
- –í—Ä–µ–º–µ–Ω–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–≤–µ—Ä–Ω—ã–π webhook URL
- –ò–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ AmoCRM —Å–µ—Ä–≤–µ—Ä

**–ö–∞–∫ –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å:**

–û—Ç–∫—Ä–æ–π—Ç–µ `locales/locales.json` –∏ –≤—Ä–µ–º–µ–Ω–Ω–æ –∏–∑–º–µ–Ω–∏—Ç–µ webhook_url:

```json
{
  "agency": {
    "webhook_url": "https://INVALID_URL_FOR_TESTING/webhook"
  }
}
```

**–®–∞–≥–∏:**
1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
2. –û—Ç–∫—Ä–æ–π—Ç–µ: https://t.me/monstrassistentbot?start=agency
3. –ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–Ω–æ–ø–∫—É

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

‚úÖ **–í AmoCRM:**
- –ù–∏—á–µ–≥–æ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è (—Ç.–∫. —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)

‚úÖ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç:**
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (–ù–ï –∑–Ω–∞–µ—Ç –æ –ø—Ä–æ–±–ª–µ–º–µ!)
- "‚úÖ –ü—Ä–∏–Ω—è—Ç–æ: –ü—Ä–∏–≤–ª–µ—á—å –∫–ª–∏–µ–Ω—Ç–æ–≤..."

‚úÖ **–í Telegram (ADMIN_CHAT_ID) –ø—Ä–∏—Ö–æ–¥–∏—Ç:**
```
‚ö†Ô∏è [FALLBACK - CRM –ù–ï–î–û–°–¢–£–ü–ù–ê] ‚ö†Ô∏è

üî• –ù–û–í–´–ô –õ–ò–î: MONSTER AGENCY üî•

‚ùóÔ∏è –í–∞–∂–Ω–æ: –≠—Ç–æ—Ç –ª–∏–¥ –ù–ï –±—ã–ª —Å–æ–∑–¥–∞–Ω –≤ AmoCRM –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
–¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–µ –≤–Ω–µ—Å–µ–Ω–∏–µ.

--- –î–ê–ù–ù–´–ï –î–õ–Ø CRM ---
–ó–∞–ø—Ä–æ—Å: –ü—Ä–∏–≤–ª–µ—á—å –∫–ª–∏–µ–Ω—Ç–æ–≤
–ö–æ–Ω—Ç–∞–∫—Ç (–∞–≤—Ç–æ): @betterrman
–ò–º—è: Galliard
--------------------------

–ó–∞–¥–∞—á–∞:
1. –í–Ω–µ—Å—Ç–∏ –ª–∏–¥ –≤ AmoCRM –≤—Ä—É—á–Ω—É—é.
2. –°–≤—è–∑–∞—Ç—å—Å—è —Å –∫–ª–∏–µ–Ω—Ç–æ–º –≤ Telegram.
```

‚úÖ **–í –ª–æ–≥–∞—Ö:**
```
‚ùå CRM-—Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–æ—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è): Cannot connect to host...
‚ö†Ô∏è Fallback: –õ–∏–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Telegram –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–Ω–µ—Å–µ–Ω–∏—è. –ü—Ä–æ—Ñ–∏–ª—å: agency, Username: @betterrman
```

‚úÖ **–ë–æ—Ç –Ω–µ –ø–∞–¥–∞–µ—Ç** ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ

---

### ‚ùå –¢–µ—Å—Ç 3: "CRM –≤–µ—Ä–Ω—É–ª–∞ –æ—à–∏–±–∫—É" (HTTP 500)

**–£—Å–ª–æ–≤–∏—è:**
- Webhook URL –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π
- –ù–æ AmoCRM –≤–µ—Ä–Ω—É–ª–∞ –æ—à–∏–±–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, 500 Internal Server Error)

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚ùå –°–¥–µ–ª–∫–∞ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ Fallback —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–º–µ—á–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã
- ‚úÖ –õ–æ–≥–∏: `‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ AmoCRM. –°—Ç–∞—Ç—É—Å: 500`

---

### ‚ùå –¢–µ—Å—Ç 4: "–¢–∞–π–º–∞—É—Ç" (CRM –º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç–≤–µ—á–∞–µ—Ç)

**–£—Å–ª–æ–≤–∏—è:**
- CRM –æ—Ç–≤–µ—á–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ 10 —Å–µ–∫—É–Ω–¥

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚ùå –ó–∞–ø—Ä–æ—Å –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ç–∞–π–º–∞—É—Ç—É
- ‚úÖ Fallback —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram
- ‚úÖ –õ–æ–≥–∏: `‚ùå –¢–∞–π–º–∞—É—Ç –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤ AmoCRM (>10s)`

---

## üîç –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:

### –£—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞:
```
üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–∏–¥–∞ –≤ AmoCRM: https://...
‚úÖ –õ–∏–¥ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ AmoCRM. –°—Ç–∞—Ç—É—Å: 200
```

### –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:
```
üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–∏–¥–∞ –≤ AmoCRM: https://...
‚ùå CRM-—Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–æ—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è): Cannot connect to host INVALID_URL_FOR_TESTING
‚ö†Ô∏è Fallback: –õ–∏–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Telegram –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–Ω–µ—Å–µ–Ω–∏—è. –ü—Ä–æ—Ñ–∏–ª—å: agency, Username: @betterrman
```

### –û—à–∏–±–∫–∞ HTTP:
```
üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–∏–¥–∞ –≤ AmoCRM: https://...
‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ AmoCRM. –°—Ç–∞—Ç—É—Å: 500, –û—Ç–≤–µ—Ç: Internal Server Error
‚ö†Ô∏è Fallback: –õ–∏–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Telegram –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–Ω–µ—Å–µ–Ω–∏—è...
```

### –¢–∞–π–º–∞—É—Ç:
```
üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–∏–¥–∞ –≤ AmoCRM: https://...
‚ùå –¢–∞–π–º–∞—É—Ç –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤ AmoCRM (>10s)
‚ö†Ô∏è Fallback: –õ–∏–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Telegram –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–Ω–µ—Å–µ–Ω–∏—è...
```

---

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞–π–º–∞—É—Ç–∞

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: **10 —Å–µ–∫—É–Ω–¥**

–ò–∑–º–µ–Ω–∏—Ç—å –º–æ–∂–Ω–æ –≤ `packages/core/utils/crm.py`:

```python
async def send_to_crm(
    webhook_url: str,
    payload: Dict[str, Any],
    timeout: int = 15  # ‚Üê –£–≤–µ–ª–∏—á—å—Ç–µ –¥–æ 15 —Å–µ–∫—É–Ω–¥
) -> bool:
```

–ò–ª–∏ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ:

```python
crm_success = await send_to_crm(webhook_url, crm_payload, timeout=20)
```

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –ü–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ –ª–∏–¥—ã | **0%** (fallback –≤ Telegram) |
| –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ | **5 —Ç–∏–ø–æ–≤ –∏—Å–∫–ª—é—á–µ–Ω–∏–π** |
| –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | **100%** |
| –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ | **–ü–æ–ª–Ω–∞—è** (–∏–º—è, username, –∑–∞–ø—Ä–æ—Å) |
| –í—Ä–µ–º—è —Ç–∞–π–º–∞—É—Ç–∞ | **10 —Å–µ–∫—É–Ω–¥** (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è) |

---

## üîß –î–µ–π—Å—Ç–≤–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –ø—Ä–∏ fallback

–ö–æ–≥–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç fallback —Å–æ–æ–±—â–µ–Ω–∏–µ:

### –®–∞–≥ 1: –í–Ω–µ—Å—Ç–∏ –ª–∏–¥ –≤ AmoCRM –≤—Ä—É—á–Ω—É—é

1. –û—Ç–∫—Ä–æ–π—Ç–µ AmoCRM
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —Å–¥–µ–ª–∫—É:
   - **–ù–∞–∑–≤–∞–Ω–∏–µ:** "–ù–æ–≤—ã–π –ª–∏–¥ —Å Telegram: MONSTER AGENCY"
   - **–ö–æ–Ω—Ç–∞–∫—Ç:** –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç —Å –∏–º–µ–Ω–µ–º –∏ username
   - **–ò—Å—Ç–æ—á–Ω–∏–∫:** "Telegram Bot"
   - **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ü—Ä–∏–≤–ª–µ—á—å –∫–ª–∏–µ–Ω—Ç–æ–≤")

### –®–∞–≥ 2: –°–≤—è–∑–∞—Ç—å—Å—è —Å –∫–ª–∏–µ–Ω—Ç–æ–º

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram
2. –ù–∞–π–¥–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ @username –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è
3. –ù–∞–ø–∏—à–∏—Ç–µ –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å follow-up

–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∏–ª –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (—Å—Å—ã–ª–∫—É, –¢–ó), –æ–Ω–∞ –ø—Ä–∏–¥—ë—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º –≤ Telegram.

---

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Ç—É–∞—Ü–∏—è

**–ß—Ç–æ –µ—Å–ª–∏ fallback —Ç–æ–∂–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç?**

–ï—Å–ª–∏ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram –Ω–µ —É–¥–∞–ª–∞—Å—å:

```python
except Exception as e:
    logger.error(f"‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å fallback –≤ Telegram: {e}")
```

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞ ‚Äî —Ç–∞–º –±—É–¥–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ª–∏–¥–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `ADMIN_CHAT_ID` –≤ `.env`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —á–∞—Ç—É

**–î–∞–Ω–Ω—ã–µ –ù–ï –ø–æ—Ç–µ—Ä—è—é—Ç—Å—è** ‚Äî –æ–Ω–∏ –±—É–¥—É—Ç –≤ –ª–æ–≥–∞—Ö:
```
‚ö†Ô∏è Fallback: –õ–∏–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Telegram –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–Ω–µ—Å–µ–Ω–∏—è.
–ü—Ä–æ—Ñ–∏–ª—å: agency, Username: @betterrman
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ `ClientConnectorError` (—Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ `ClientResponseError` (HTTP –æ—à–∏–±–∫–∏)
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ `TimeoutError` (—Ç–∞–π–º–∞—É—Ç—ã)
- [x] –î–µ—Ç–∞–ª—å–Ω–æ–µ fallback —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫
- [x] –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- [x] –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞
- [x] –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## üìö –°–≤—è–∑–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `AMOCRM_INTEGRATION.md` ‚Äî –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AmoCRM
- `README.md` ‚Äî –û–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `DEVELOPER_NOTES.md` ‚Äî –ó–∞–º–µ—Ç–∫–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-10-24
**–í–µ—Ä—Å–∏—è:** 2.1 (Fallback Mechanism)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready
